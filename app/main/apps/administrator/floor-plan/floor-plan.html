<div id="eshl-live" class="page-layout simple right-sidenav" layout="row">
  <div  class="center" flex ms-scroll>
    <!-- HEADER -->
    <div class="header md-accent-bg" layout="row" layout-align="space-around center">
      <md-divider flex="10"></md-divider>
      <div flex="50" layout="row" layout-align="start center" >
        <img src="assets/images/bos.png" width="10%" height="10%" style="min-width:40px;"/>
        <div layout="column">
          <span class="headerFont" >BOS Panel</span>
          <span class="subHeaderFont" style="margin-top: -5px; margin-left: 1px">Building Operating System GUI</span>
        </div>
      </div>

      <div flex="40" layout="row" layout-align="space-around center" >
        <div flex="40" id="weather" layout="column" layout-align="space-around center" class="timeFont"></div>
        <div flex="40" layout="column" layout-align="end center" style="margin-left: 0%">
          <span id="time" class="md-caption timeFont">{{getDate | date:'HH:mm:ss'}}</span>
          <span id="week" class="md-caption timeFont" style="padding-top: 5%">{{getDate | date:'EEE'}}</span>
          <span id="date" class="md-caption timeFont" style="padding-top: 5%">{{getDate | date:'dd/MM/yyyy'}}</span>
        </div>
        <div flex="20" class="toolbar" style="margin-left: 0%">
          <md-button class="md-icon-button sidenav-toggle" ng-click="vm.toggleSidenav('sidenav')" hide-gt-md
                     aria-label="Toggle sidenav">
            <md-icon md-font-icon="icon-menu" class="icon"></md-icon>
          </md-button>
        </div>
      </div>
    </div>

    <!-- CONTENT -->
    <div id="eshl-floorplan" class="content">
      <md-tabs md-dynamic-height md-selected="vm.selectedIndex">

        <md-tab ng-repeat="tab in vm.tabs"
                ng-disabled="tab.disabled"
                label="{{tab.title}}">

          <!--<input type="file" id="{{'deviceImageUpload_'+tab.title}}" ng-click="inputFileClick(this)" onchange="angular.element(this).scope().deviceImageChanged(this)" style="visibility: hidden">-->

          <div layout="row" layout-align="space-between start" style="margin-top: 10px">

            <div layout="column" layout-align="start center">
              <div id="{{'container_floorPlan_'+tab.title.replace(' ','_')}}" resizable on-resize="containerResize()"  style="width:40vw;height:30vh;border:1px solid black">

                <div id="{{'container_'+tab.title.replace(' ','_')}}"></div>
              </div>
              <div layout="column" layout-align="start center" style="margin-top: 10px">
                <md-button class="md-accent md-raised" ng-click="clickUpload('floorPlanUpload_')" ng-disabled="vm.tabs.length <= 0">{{'FLOOR_PLAN.UPLOAD_FLOOR_PLAN'|translate}}</md-button>
<!--
                <md-button class="md-accent md-raised" ng-click="vm.removeTab()" ng-disabled="vm.tabs.length <= 0">{{'FLOOR_PLAN.REMOVE_CURRENT_FLOOR_PLAN'|translate}}</md-button>
-->
                <input type="file" id="{{'floorPlanUpload_'+tab.title.replace(' ','_')}}" onclick="return angular.element(this).scope().inputFileClick();" onchange="angular.element(this).scope().floorPlanChanged(this)" style="visibility: hidden">

              </div>
            </div>


            <div></div>

           <!-- <div flex="30">
              <div class="expandcollapse-item" ng-repeat="room in vm.selectedFloor.rooms" >
                <div ng-click="active = !active" ng-class="{'expandcollapse-heading-collapsed': active, 'expandcollapse-heading-expanded': !active}">
                  <table width="100%">
                    <tr>
                      <td width="50%"><p>{{room.name}}</p></td>
                      <td width="50%">
                        <div layout="row" layout-align="end center" style="float: right">
                          <md-button ng-if="!active"  style="margin-right: 50px;color: white" ng-disabled="room.selectedDevices.length===0" ng-click="vm.removeDevicesFromRoom(room)">
                            <u><p>{{'DEVICES_ADMIN.REMOVE_DEVICES'|translate}}</p></u>
                          </md-button>

                          <p >{{room.deviceNum}}</p>
                        </div>

                      </td>
                    </tr>
                  </table>
                </div>

                <div class="slideDown" ng-hide="active">
                  <div class="expand-collapse-content" layout="row"  layout-wrap>
                    <div ng-repeat="device in vm.devices" ng-if="device.floor === floor.name && device.room === room.name "  layout="row" layout-align="start center" style="width: 100px">
                      <div >
                        <md-button aria-label="md-checkbox" class="deviceframe" ng-style="{'background-color':room.selectedDevices.indexOf(device)>=0? vm.activeTheme.accent.color:'transparent'}" ng-click="vm.toggle(device,room.selectedDevices)">
                          <div >
                            <img src={{device.image}} width="35px" height="35px" align="center"  />
                          </div>
                          <md-tooltip>{{device.id}}</md-tooltip>
                        </md-button>
                      </div>

                    </div>
                  </div>
                </div>
              </div>

            </div>-->

            <div layout="column" layout-align="center center">
              <md-sidenav class="md-sidenav-right" md-component-id="right" md-is-locked-open="$mdMedia('gt-md')"
                          md-disable-backdrop md-whiteframe="4"  style="height: auto;">

                <md-toolbar class="md-accent" style="min-height: 45px;max-height: 45px">
                  <div layout="column" layout-align="start center" style="margin-top: -7px">
                    <h2>Add devices to the floor plan</h2>
                  </div>

                </md-toolbar>
                <md-content >
                  <div class="pl-16 pr-8 pv-16" layout="column">
                    <!--<div layout="column" layout-align="center center">
                      <span class="h3 secondary-text mat-line">Devices in this floor</span>
                    </div>-->
                    <div layout="column" ng-repeat="room in vm.selectedFloor.rooms">
                      <div  layout="column" layout-align="start start" >
                        <div layout="row" layout-align="start center">
                          <!--<img src="assets/images/location.png" class="icon mr-8 s20" style="width: 25px;height:auto">-->
                          <span  class="h4">{{room.name}}</span>
                        </div>
                        <hr style="border-top: 1px solid rgba(140, 139, 139, 0.4); width: 100%; margin-top: 5px">
                      </div>
                      <div>
                        <!--<md-checkbox aria-label="md-checkbox" ng-model="image.check" ng-change="vm.checkDeviceImage(this)" ng-repeat="device in vm.devices" ng-if="device.floor === vm.selectedFloor.name && device.room === room.name ">
                          <img src={{device.image}} width="30px" height="30px" align="center"  />
                          <md-tooltip>
                            {{device.id}}
                          </md-tooltip>
                        </md-checkbox>-->
                        <md-button aria-label="md-checkbox" class="btn1"  ng-click="vm.addDevicesToFloorPlanNew(room,device)" ng-repeat="device in room.remainingDevices">
                          <div >
                            <img src={{device.image}} width="30px" height="30px" align="center"  />
                          </div>
                          <md-tooltip>{{device.id}}</md-tooltip>
                        </md-button>
                        <div style="color: grey;display: table;margin: 0 auto;padding-bottom: 10px" ng-if="room.remainingDevices.length===0">No devices left in this room</div>
                      </div>

                    </div>

                  </div>
                </md-content>

                <!--<md-toolbar class="md-accent">
                  <h1 class="md-toolbar-tools">Devices in this floor</h1>
                </md-toolbar>

                <md-content layout-margin>

                  <div class="expandcollapse-item" ng-repeat="room in vm.selectedFloor.rooms" >
                    <div ng-click="active = !active" ng-class="{'expandcollapse-heading-collapsed': active, 'expandcollapse-heading-expanded': !active}">
                      <table width="100%">
                        <tr>
                          <td width="50%"><p>{{room.name}}</p></td>
                          <td width="50%">
                            <div layout="row" layout-align="end center" style="float: right">
                              <md-button ng-if="!active"  style="margin-right: 50px;color: white" ng-disabled="room.selectedDevices.length===0" ng-click="vm.removeDevicesFromRoom(room)">
                                <u><p>{{'DEVICES_ADMIN.REMOVE_DEVICES'|translate}}</p></u>
                              </md-button>

                              <p >{{room.deviceNum}}</p>
                            </div>

                          </td>
                        </tr>
                      </table>
                    </div>

                    <div class="slideDown" ng-hide="active">
                      <div class="expand-collapse-content" layout="row"  layout-wrap>
                        <div ng-repeat="device in vm.devices" ng-if="device.floor === floor.name && device.room === room.name "  layout="row" layout-align="start center" style="width: 100px">
                          <div >
                            <md-button aria-label="md-checkbox" class="deviceframe" ng-style="{'background-color':room.selectedDevices.indexOf(device)>=0? vm.activeTheme.accent.color:'transparent'}" ng-click="vm.toggle(device,room.selectedDevices)">
                              <div >
                                <img src={{device.image}} width="35px" height="35px" align="center"  />
                              </div>
                              <md-tooltip>{{device.id}}</md-tooltip>
                            </md-button>
                          </div>

                        </div>
                      </div>
                    </div>
                  </div>

                </md-content>-->

              </md-sidenav>
              <md-button ng-click="vm.toggleRight()" class="md-raised" ng-if="isMedium">
                {{'FLOOR_PLAN.SHOW_DEVICE_PANEL'|translate}}
              </md-button>
            </div>

            <!--<md-button class="md-accent" onclick="console.log('floorPlanUpload_'+'{{tab.title}}'); document.getElementById('floorPlanUpload_'+'{{tab.title}}').click(); return false; ">Upload Floor Plan</md-button>-->

          </div>


        </md-tab>

      </md-tabs>
<!--
      <md-button class="md-accent md-raised" ng-click="vm.removeTab()" ng-disabled="vm.tabs.length <= 0">{{'FLOOR_PLAN.REMOVE_CURRENT_FLOOR_PLAN'|translate}}</md-button>
      <md-button class="md-accent md-raised" ng-click="clickUpload('floorPlanUpload_')" ng-disabled="vm.tabs.length <= 0">{{'FLOOR_PLAN.UPLOAD_FLOOR_PLAN'|translate}}</md-button>
      <md-button id="btnToggleLibrary" class="md-accent md-raised" ng-click="vm.toggleDeviceLibrary()" ng-show = "!vm.IsDeviceLibraryVisible" ng-disabled="vm.tabs.length <= 0">{{'FLOOR_PLAN.SHOW_DEVICE_LIBRARY'|translate}}</md-button>
      <md-button id="btnHideLibrary" class="md-accent md-raised" ng-click="vm.toggleDeviceLibrary()" ng-show = "vm.IsDeviceLibraryVisible" ng-disabled="vm.tabs.length <= 0">{{'FLOOR_PLAN.HIDE_DEVICE_LIBRARY'|translate}}</md-button>
      <md-button id="btnAddDevices"  ng-show = "vm.IsDeviceLibraryVisible" class="md-accent md-raised" ng-click="vm.addDevicesToFloorPlan()"  ng-disabled="vm.tabs.length <= 0">{{'FLOOR_PLAN.ADD_NEW_DEVICES'|translate}}</md-button>
-->

      <!--<div id="{{'container_images_'+vm.selectedTabTitle}}" ng-show = "vm.IsDeviceLibraryVisible" class="md-padding">
        <md-checkbox aria-label="md-checkbox" ng-model="image.check" ng-change="vm.checkDeviceImage(this)" ng-repeat="image in vm.images" >
          <img src={{image.url}} width="40px" height="40px" align="center"  />
          <md-tooltip>
            {{image.id}}
          </md-tooltip>
        </md-checkbox>
      </div>
      <br/>


      <form ng-submit="vm.addTab(tTitle)" layout="column" class="md-padding">

        <div layout="row" layout-align="start center">

          <div flex="10" style="position: relative;" md-colors="::{color: '{{vm.activeTheme.accent.color}}'}">
            <h2 class="md-subhead " ng-style="{'text-transform': 'uppercase', 'color': vm.activeTheme.accent.color}" >{{'FLOOR_PLAN.ADD_NEW_FLOOR'|translate}}:</h2>
          </div>
          <md-input-container style="margin-bottom: 2px">
            <label for="label">{{'FLOOR_PLAN.FLOOR_NAME'|translate}}</label>
            <input type="text" id="label" ng-model="tTitle">
          </md-input-container>

          <md-button class="md-accent md-raised" ng-disabled="!tTitle" type="submit" style="margin-right: 0;">{{'FLOOR_PLAN.ADD'|translate}}</md-button>

        </div>
      </form>-->

    </div>

  </div>



</div>
<script src="assets/lib/jquery.simpleWeather.js"></script>
<script src="assets/lib/weather.js"></script>
<script src="app/main/apps/dweller/device-overview/floor-plan/floor-plan.js"></script>
<style>
  .btn1 {
    padding: 0 0px 0 0px;
    margin: 0px 5px 0px 5px;
    min-width: 18px;
    border-radius: 3px;
    font-size: 14px;
    text-align: center;
    text-transform: uppercase;
    text-decoration:none;
    border: none;
    outline: none;
  }
</style>

<script type="text/javascript">


  function isJson(str) {
    try {
      JSON.parse(str);
    } catch (e) {
      return false;
    }
    return true;
  }
  //save initial scale

 /* var initialScale = window.stage.scale(); //returns {x: 1, y: 1}
  var initialWidth = $("#container_floorPlan_One").innerWidth(); // initial width
  var initialHeight = $("#container_floorPlan_One").innerHeight(); // initial height
  var isContainerResize=false; // if the container is resized, the scaled will also be changed*/



</script>


